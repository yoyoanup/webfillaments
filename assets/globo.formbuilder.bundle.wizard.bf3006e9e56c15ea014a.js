"use strict";(self.webpackChunkgloboFormbuilder=self.webpackChunkgloboFormbuilder||[]).push([[32],{906:(t,e,s)=>{s.r(e),s.d(e,{default:()=>o});var i=s(1651);const o={Wizard:class{constructor(t,e){this.form=t,this.wizard=e,this.panels=new Globo.FormBuilder.Panels(this.wizard),this.steps=new Globo.FormBuilder.Steps(this.wizard),this.stepsQuantity=this.steps.getStepsQuantity(),this.currentStep=this.steps.currentStep,this.nextText=e.querySelector(".action.next").getAttribute("data-next-text"),this.submitText=e.querySelector(".action.next").getAttribute("data-submit-text"),this.submittingText=e.querySelector(".action.next").getAttribute("data-submitting-text"),this.concludeControlMoveStepMethod=this.steps.handleConcludeStep.bind(this.steps),this.wizardConclusionMethod=this.handleWizardConclusion.bind(this),this.steps.handleHeaderSteps()}init(){const t=this.form.querySelector(".next"),e=this.form.querySelector(".previous");this.addControls(e,t),this.setStep(0);const s=this.form.querySelectorAll(".panel[data-connected-id][data-connected-value]");s.length&&this.handleConditionalPanels(s)}updateButtonsStatus(){0===this.currentStep?this.previousControl.classList.add("disabled","hidden"):this.previousControl.classList.remove("disabled","hidden")}updtadeCurrentStep(t){this.currentStep+=t,this.steps.setCurrentStep(this.currentStep),this.panels.setCurrentStep(this.currentStep),this.handleNextStepButton(),this.updateButtonsStatus()}setStep(t){this.currentStep=t,this.steps.setCurrentStep(this.currentStep),this.panels.setCurrentStep(this.currentStep),this.handleNextStepButton(),this.updateButtonsStatus()}handleNextStepButton(){const t=this;this.nextControl.type="button",this.nextControl.addEventListener("click",this.nextControlMoveStepMethod),this.stepsQuantity=this.steps.getStepsQuantity(),t.currentStep===t.stepsQuantity-1?(t.nextControl.innerHTML=t.submitText,this.nextControl.addEventListener("click",this.wizardConclusionMethod)):(t.nextControl.innerHTML=t.nextText,this.nextControl.removeEventListener("click",this.wizardConclusionMethod))}handleWizardConclusion(){this.wizard.classList.add("completed"),this.nextControl.type="submit"}addControls(t,e){this.previousControl=t,this.nextControl=e,this.previousControlMoveStepMethod=this.moveStep.bind(this,-1),this.nextControlMoveStepMethod=this.moveStep.bind(this,1),t.addEventListener("click",this.previousControlMoveStepMethod),e.addEventListener("click",this.nextControlMoveStepMethod),this.updateButtonsStatus()}getCoords(t){var e=t.getBoundingClientRect(),s=document.body,i=document.documentElement,o=window.pageYOffset||i.scrollTop||s.scrollTop,n=window.pageXOffset||i.scrollLeft||s.scrollLeft,r=i.clientTop||s.clientTop||0,l=i.clientLeft||s.clientLeft||0,a=e.top+o-r,h=e.left+n-l;return{top:Math.round(a),left:Math.round(h)}}scrollTop(){var t=(0,i.oq)(this.wizard,".globo-formbuilder");if(t.querySelector(".float-layout"));else{let e={behavior:"smooth",left:0},s=!1;void 0!==Globo.FormBuilder.shop.settings?(void 0===Globo.FormBuilder.shop.settings.scrollTop||void 0!==Globo.FormBuilder.shop.settings.scrollTop&&Globo.FormBuilder.shop.settings.scrollTop)&&(s=!0):void 0!==Globo.FormBuilder.shop.settings&&(void 0===Globo.FormBuilder.shop.settings.scrollTop||void 0!==Globo.FormBuilder.shop.settings.scrollTop&&Globo.FormBuilder.shop.settings.scrollTop)&&(s=!0),s&&(e.top=this.getCoords(t).top),setTimeout((()=>window.scrollTo(e)),1)}}moveStep(t){if(Globo.FormBuilder.handleValidate(this.wizard),1==t&&this.wizard.querySelector(".block-container.errors[data-step='"+this.currentStep+"']"))return void this.panels.updatePanelsContainerHeight();this.scrollTop(),this.removeValidateErrors(),1==t&&(this.currentStep!==this.steps.getStepsQuantity()-1&&this.nextControl.removeEventListener("click",this.wizardConclusionMethod),this.concludeControlMoveStepMethod()),this.validateMovement(t)&&(this.updtadeCurrentStep(t),this.steps.handleStepsClasses(t));const e=new CustomEvent("globo.formbuilder.step.move",{detail:{wizard:this.wizard,currentStep:this.currentStep}});document.dispatchEvent(e)}validateMovement(t){const e=t>0&&this.currentStep<this.stepsQuantity-1,s=t<0&&this.currentStep>0;return e||s}reset(){var t=this.wizard.querySelector(".next"),e=this.wizard.querySelector(".previous");t.replaceWith(t.cloneNode(!0)),e.replaceWith(e.cloneNode(!0)),t=this.wizard.querySelector(".next"),e=this.wizard.querySelector(".previous"),this.addControls(e,t),this.setStep(0),this.steps.handleRemoveAllConcludeStep(),this.removePanelErrors()}removePanelErrors(){let t=this.wizard.querySelectorAll(".panel");t&&t.forEach((t=>{t.classList.remove("errors")}))}removeValidateErrors(){let t=this.wizard.querySelectorAll(".globo-form-control.has-error");t&&t.forEach((t=>{t.classList.remove("has-error"),t.querySelector(".messages").innerHTML=""}))}handleConditionalPanels(t){const e=this;t.forEach((function(t){const s=t.getAttribute("data-connected-id"),i=t.getAttribute("data-connected-value");let o=e.form.querySelectorAll('[name="'+s+'"]');o.length||(o=e.form.querySelectorAll('[name="'+s+'[]"]')),o.length&&o.forEach((o=>{("select"==o.name&&o.value||o.checked)&&e.handleSetConditionalPanels(o,t,s,i),o.addEventListener("change",(function(){e.handleSetConditionalPanels(o,t,s,i)}))}))}))}handleSetConditionalPanels(t,e,s,i){if("checkbox"==t.type){let s=[];const r=t.closest(".globo-form-control").querySelectorAll('[name="'+t.name+'"]:checked');r.length&&(s=[...r].map((t=>t.value))),s.length&&s.includes(i)?n(this.form,e):o(this.form,e)}else t.value!==i?o(this.form,e):n(this.form,e);if(this.steps.handleHeaderSteps(),this.handleNextStepButton(),!e.classList.contains("hidden")){const t=parseInt(e.getAttribute("data-step")),i=e.parentElement.querySelector('.panel[data-step="'+(t-1)+'"][data-connected-id="'+s+'"]');i&&(e.setAttribute("data-step",t-1),i.setAttribute("data-step",t),i.before(e))}function o(t,e){e.classList.add("hidden"),r((function(){t.querySelector('.step[data-step="'+e.getAttribute("data-step")+'"]').classList.add("hidden")}),100,2)}function n(t,e){e.classList.remove("hidden"),r((function(){t.querySelector('.step[data-step="'+e.getAttribute("data-step")+'"]').classList.remove("hidden")}),100,2)}function r(t,e,s){t();var i=0,o=window.setInterval((function(){t(),++i===s&&window.clearInterval(o)}),e)}}},Steps:class{constructor(t){this.wizard=t,this.steps=this.getSteps(),this.stepsQuantity=this.getStepsQuantity(),this.currentStep=0}setCurrentStep(t){this.currentStep=t}getSteps(){return this.wizard.querySelectorAll(".step:not(.hidden)")}getStepsQuantity(){return this.getSteps().length}handleConcludeStep(){this.steps=this.getSteps(),this.steps[this.currentStep].classList.add("-completed")}handleRemoveAllConcludeStep(){this.steps=this.getSteps(),this.stepsQuantity=this.getStepsQuantity();for(var t=0;t<this.stepsQuantity;t++)this.steps[t].classList.remove("-completed")}handleStepsClasses(t){this.steps=this.getSteps(),t>0?this.steps[this.currentStep-1].classList.add("-completed"):t<0&&this.steps[this.currentStep].classList.remove("-completed"),this.stepsQuantity=this.getStepsQuantity(),this.steps[this.stepsQuantity-1].classList.remove("-completed")}handleHeaderSteps(){this.steps=this.getSteps(),this.stepsQuantity=this.getStepsQuantity(),this.stepsQuantity>1?this.wizard.querySelector(".steps").classList.remove("hidden"):this.wizard.querySelector(".steps").classList.add("hidden"),this.steps.forEach(((t,e)=>{e+1!=this.stepsQuantity?t.classList.remove("last"):t.classList.add("last")}))}},Panels:class{constructor(t){this.wizard=t,this.panelWidth=this.wizard.offsetWidth,this.panelsContainer=this.getPanelsContainer(),this.panels=this.getPanels(),this.currentStep=0,this.updatePanelsPosition(this.currentStep),this.updatePanelsContainerHeight()}getCurrentPanelHeight(){return this.panels=this.getPanels(),`${this.getPanels()[this.currentStep].offsetHeight}px`}getPanelsContainer(){return this.wizard.querySelector(".panels")}getPanels(){return this.wizard.querySelectorAll(".panel:not(.hidden)")}updatePanelsContainerHeight(){this.panelsContainer.style.height=this.getCurrentPanelHeight()}updatePanelsPosition(t){const e=this.getPanels();this.panelWidth;for(let s=0;s<e.length;s++)if(e[s].classList.remove("movingIn"),e[s].classList.remove("movingOutBackward"),e[s].classList.remove("movingOutFoward"),e[s].classList.remove("block-container"),s!==t)s<t?e[s].classList.add("movingOutBackward"):s>t&&e[s].classList.add("movingOutFoward");else{if(e[s].classList.contains("hidden"))return void this.setCurrentStep(t+1);e[s].classList.add("movingIn"),e[s].classList.add("block-container")}this.updatePanelsContainerHeight()}setCurrentStep(t){this.currentStep=t,this.updatePanelsPosition(t)}}}}}]);